config:
  phases:
    - name: 300s_1rps
      duration: 300
      arrivalRate: 1
  ensure:
    maxErrorRate: 0
    thresholds:
      - http.response_time.min: 1000
      - http.response_time.mean: 2000
      - http.response_time.p95: 2000
      - http.response_time.p99: 3000
      - http.response_time.max: 5000
  variables:
    transaction_type: ["CREDIT", "DEBIT"]
    payment_type: ["TARGET", "SEPA", "MT103", "SEPA-INSTANT"]
  payload:
    - path: "../data/TradeStation.csv"
      fields:
        - clientReference
        - accountReference
        - effectiveDateTime
        - iban
        - paymentType
        - paymentSubtype

scenarios:
  - name: "Test Tradestation Ongoing Transaction in PP"
    flow:
      - post:
          url: "/TruAccountAPI/rest/Accounts/v1/RunStrategy"
          json:
            {
                "accountStrategyId": 1547,
                "accountReference": "{{ accountReference }}",
                "application": {
                },
                    "financialAccount": {
                    "clientReference": "{{ clientReference }}",
                    "accountNumber": "{{ accountReference }}",
                    "productName": "Equities",
                    "productCode": "Individual",
                    "financialTransaction": [
                        {
                            "clientReference": "{{ clientReference }}",
                            "sortCode": "000000",
                            "accountNumber": "56879N6H69712345",
                            "accountHolder": "Donald Trump",
                            "effectiveDateTime": "{{ effectiveDateTime }} 00:00:00",
                            "creditOrDebit": "{{ transaction_type }}",
                            "currencyCode": "USD",
                            "paymentType": "{{ paymentType }}",
                            "paymentSubtype": "{{ paymentSubtype }}",
                            "countryOfTransaction": "USA",
                            "amount": "{{ $randAmount() }}",
                            "balance": "",
                            "paymentReference": "",
                            "thirdParty": "Donal Trump",
                            "thirdPartyId": "{{ $randCatchPhrase() }}",
                            "IBAN": "BankofAmerica{{ iban }}"
                        }
                    ]
                }
            }

